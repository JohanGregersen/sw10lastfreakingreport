\subsubsection{Storage Server}\label{subsec:storageserver}
The storage server contains two layers: a trip-processing layer, a physical storage layer.

The trip-processing layer handles the processing of new trips when it receives a stream of raw GPS data. The purpose of this layer is immensely specific, but the functionality it encapsulates is comprehensive. This layer is intentionally removed from the logic layer and placed on the storage-server to optimize the use of computational-resources. It also allows the fastest possible retrieval and updating of data in the database, as the trip-processing layer can utilize localhost-querying, removing the network communication overhead between the two servers. This layer completes seven steps to process a new trip, and these steps are listed below:

\paragraph{The steps it takes to process a new trip}
\begin{itemize}
\item Deserialize from raw GPS data from JSON to C\#-objects
\item Insert a new trip in the database, and obtain the assigned new tripid to this trip
\item Insert the raw GPS coordinates and timestamp in the GPSFact-table by carid and the new tripid
\item Call third party software to map-match the raw GPS coordinates. The GPS data is parsed to CSV-format, and then a RESTful API is called to map-match the data. The API returns a set of road-segments used on this trip, and the collection of map-matched GPS coordinates. Then the entries in the GPSFact-table in the database is updated with the map-matched GPS coordinates, road-segment-ids and speed limits.
\item Compute measures and flags for the entire trip in the GPSFact-table. Measures are attributes like speed, and acceleration, etc. Flags are attributes that tell whether the driver is speeding, or accelerating, etc. Unusable GPS points are removed, these are outliers with same timestamp, making it impossible to compute measures with a division of 0 as time-passed since last point. The updated GPSFact entries are then updated in the GPSFact-table with the computed measures and flags.
\item Compute the attributes in the TripFact-entry: length of the trip, how long it took, the optimalscore, the tripscore, and the count of each delinquency, etc. The attributes in the TripFact-entry are then updated in the database. The entire list of attributes can be seen in Appendix \ref{app:datawarehouse}.
\item Check whether the car is enrolled in a competition, and if so, check whether the trip is valid for use in the competition. If it is, update the CompetingIn-table, with the corresponding score and increased number of attempts. 
\end{itemize}

The physical storage layer is where the database is hosted. The database is a modified version of the data-warehouse schema presented in \cite{sw9_report}, hosted through the open-source DBMS, PostgreSQL\cite{postgresql}. The modified data-warehouse schema can be seen in Appendix \ref{app:datawarehouse}.