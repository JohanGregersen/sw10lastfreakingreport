\subsubsection{API Server}\label{subsec:impl_api_server}
As portrayed in Figure \ref{fig:backend_design} the API server consists of 3 layers, first up is the Communication Layer.

The communication layer is fully implemented in C\# as a RESTful Web Service API, using the build-in .NET \texttt{ServiceModel} library. It is implemented following the design described in Section \ref{sec:api_server}. The biggest addition is error-handling, and error-report-system. The communication layer obviously should not crash, because the access to the Drive-LaB backend will crash with it. The error-handling ensures that corrupted data being processed in the logic layer, does not cast exceptions back to the communication layer. Also, by using the .NET RESTful library, a series of error-handling is conducted by the library. as an example, like what happens if you target a non-existent service endpoint, or if you do not obey the HTTP-methods like GET or POST, the API will then autonomously return a corresponding HTTP status code.

Next up is the the Logic Layer. It is implemented in C\# using regular OOP-style programming. It contains a lot of classes and methods to handle the big variety of functionality handled in this layer. A majority of this functionality is to create the appropriate C\# objects, either based on data in JSON-format received from the communication layer, or data in raw \texttt{DataRow} format from the data access layer(DAL). DataRow is a .NET specific data type, designed to hold a row of data received from a database connection, which is what the DAL returns to the logic layer.  

The logic layer uses Json.NET, a popular JSON framework for .NET \citep{json_dot_net}. This makes it easy to serialize C\# objects to JSON-format. It is done by implementing a \texttt{DataContract} inside the class. It was necessary to import a library to handle this serialization/de-serialization, because the Mono cannot run all the Visual Studio specific libraries. Another library that is not Mono-compatible is the \texttt{Device.Location}, which offers the custom type \texttt{GeoCoordinate} in C\#. It is used to store spatio-temporal data, and offers functionality like computing distance between two coordinates. A library called GeoCoordinatePortable offers this functionality while being Mono-compatible, and is naturally used as substitute \citep{geocoordinateportable}.

Lastly is the Data Access Layer. The data access layer(DAL) is implemented using a combination of SQL and C\#. It makes use of \texttt{Npgsql} \citep{npgsql}, a .NET data provider for PostgreSQL, which makes it very easy to write SQL statements and C\# code in the same IDE. 